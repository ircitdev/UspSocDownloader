# Telegram Bot Setup - –ó–∞–≤–µ—Ä—à–µ–Ω–æ ‚úì

**–î–∞—Ç–∞:** 04.12.2025
**–≠—Ç–∞–ø:** –î–µ–Ω—å 1-2 –∏–∑ DEVELOPMENT_PLAN.md
**–°—Ç–∞—Ç—É—Å:** ‚úì –ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

---

## üìã –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`src/config.py`)

- ‚úì –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ `.env`
- ‚úì –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (logs, data, temp)
- ‚úì –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞
- ‚úì –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–ª–æ–≥-—É—Ä–æ–≤–µ–Ω—å, —Ç–∞–π–º–∞—É—Ç—ã, –ª–∏–º–∏—Ç—ã)

### 2. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`src/utils/logger.py`)

- ‚úì –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å
- ‚úì –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª `logs/bot.log`
- ‚úì –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (–º–∞–∫—Å 10MB –Ω–∞ —Ñ–∞–π–ª, 5 –±—ç–∫–∞–ø–æ–≤)
- ‚úì –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ —Å –≤—Ä–µ–º–µ–Ω–µ–º

### 3. Bot Framework (`src/bot.py`)

- ‚úì –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Bot (aiogram 3.x)
- ‚úì –°–æ–∑–¥–∞–Ω–∏–µ Dispatcher
- ‚úì –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è bot commands –≤ Telegram
- ‚úì Graceful shutdown

### 4. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

#### `/start` –∫–æ–º–∞–Ω–¥–∞ (`src/handlers/start.py`)

```
üëã –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
üì± –°–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
üí° –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
```

#### `/help` –∫–æ–º–∞–Ω–¥–∞ (`src/handlers/help.py`)

```
‚ùì –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞
üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚öôÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
üÜò –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º
```

### 5. Main Entry Point (`src/main.py`)

- ‚úì Async entry point
- ‚úì –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- ‚úì Graceful error handling
- ‚úì Polling mode –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã ‚úì

```
[PASS] /start handler
[PASS] /help handler
[SUCCESS] All handler tests passed!
```

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```powershell
python test_handlers.py
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º (polling)

```powershell
python src/main.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**

```
2025-12-04 XX:XX:XX,XXX - bot - INFO - Starting UspSocDownloader
2025-12-04 XX:XX:XX,XXX - bot - INFO - Creating bot instance - UspSocDownloader
2025-12-04 XX:XX:XX,XXX - bot - INFO - Bot commands configured
2025-12-04 XX:XX:XX,XXX - bot - INFO - Starting bot polling...
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞

–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

---

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Telegram

### 1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞

Telegram: **@UspSocDownloader_bot**

### 2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã

#### `/start`

–ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

#### `/help`

–ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é —Å–ø—Ä–∞–≤–∫—É —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

```
src/
‚îú‚îÄ‚îÄ config.py                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–æ–≤—ã–π)
‚îú‚îÄ‚îÄ bot.py                       # Bot framework (–Ω–æ–≤—ã–π)
‚îú‚îÄ‚îÄ main.py                      # Entry point (–æ–±–Ω–æ–≤–ª–µ–Ω)
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ logger.py                # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–æ–≤—ã–π)
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py              # Module init (–Ω–æ–≤—ã–π)
‚îÇ   ‚îú‚îÄ‚îÄ start.py                 # /start handler (–Ω–æ–≤—ã–π)
‚îÇ   ‚îî‚îÄ‚îÄ help.py                  # /help handler (–Ω–æ–≤—ã–π)

logs/
‚îî‚îÄ‚îÄ bot.log                       # –õ–æ–≥ —Ñ–∞–π–ª (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è)

test_bot_setup.py                # Unit —Ç–µ—Å—Ç—ã (–Ω–æ–≤—ã–π)
test_handlers.py                 # Handler —Ç–µ—Å—Ç—ã (–Ω–æ–≤—ã–π)
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### `.env` —Ñ–∞–π–ª

```env
# Telegram Bot
BOT_TOKEN=8511650801:AAEGVXeNJeHHhl-ryB8qvQ0dTLTNse-IDK0
BOT_USERNAME=UspSocDownloader_bot

# Application
APP_NAME=UspSocDownloader
DEBUG=True

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s

# Limits
MAX_FILE_SIZE=52428800  # 50MB
MAX_VIDEO_DURATION=600  # 10 min
DOWNLOAD_TIMEOUT=300    # 5 min
```

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
User (Telegram)
    ‚Üì
Dispatcher (aiogram)
    ‚îú‚îÄ‚îÄ /start ‚Üí start.router ‚Üí start_command()
    ‚îî‚îÄ‚îÄ /help  ‚Üí help.router  ‚Üí help_command()
    ‚Üì
Logger (console + file)
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–î–µ–Ω—å 3-4)

–ü–æ –ø–ª–∞–Ω—É –∏–∑ DEVELOPMENT_PLAN.md:

1. **URL Processor** (`src/processors/url_processor.py`)
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø–æ URL
   - –í–∞–ª–∏–¥–∞—Ü–∏—è URL
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ post ID

2. **URL Handler** (`src/handlers/url_handler.py`)
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
   - –ü–∞—Ä—Å–∏–Ω–≥ URL
   - –û—Ç–≤–µ—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - Unit —Ç–µ—Å—Ç—ã –¥–ª—è URL processor
   - Integration —Ç–µ—Å—Ç—ã

---

## üìù –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

- [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ aiogram 3.x (v3.7.0)
- [x] Async/await —Å—Ç–∏–ª—å –∫–æ–¥–∞
- [x] –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ .env
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª `logs/bot.log`
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å try/except
- [x] Graceful shutdown
- [x] –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] Unit —Ç–µ—Å—Ç—ã
- [x] –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

---

## üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã

```
aiogram==3.7.0              # Telegram Bot Framework
aiohttp==3.11.11            # Async HTTP client
aiofiles==24.1.0            # Async file operations
yt-dlp==2024.12.13          # Media downloader
python-dotenv==1.0.1        # .env support
validators==0.34.0          # URL validation
Pillow==11.0.0              # Image processing
requests==2.32.3            # HTTP requests
```

---

## üìû –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
python src/main.py

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
python test_bot_setup.py
python test_handlers.py

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
Get-Content logs/bot.log -Tail 20

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω black)
black src/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω flake8)
flake8 src/
```

---

## ‚úì –ß–µ–∫-–ª–∏—Å—Ç –¥–Ω—è 1-2

- [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [x] –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] Bot framework –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- [x] –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
- [x] Main entry point
- [x] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

**–°—Ç–∞—Ç—É—Å:** ‚úì –ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 04.12.2025 20:42

**–ê–≤—Ç–æ—Ä:** GitHub Copilot + Claude AI

---

–î–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–ª–µ–¥—É–π—Ç–µ –ø–ª–∞–Ω—É –≤ [DEVELOPMENT_PLAN.md](../DEVELOPMENT_PLAN.md)
